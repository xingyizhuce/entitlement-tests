- job-template:
   name: ContainerSAT6TestingTrigger
   node: entitlement
   wrappers:
        - ansicolor
        - workspace-cleanup
   parameters:
        - string:
            name: Distro_RHEL7
            default: RHEL-7.5
            description: Input the RHEL7 compose ID here, such as RHEL-7.5.
        - string:
            name: Distro_RHEL8
            default: RHEL-8.0
            description: Input the RHEL8 compose ID here, such as RHEL-8.0.
        - string:
            name: Distro_RHEL_ALT
            default: RHEL-ALT-7.5
            description: Input the RHEL-ALT compose ID here, such as RHEL-ALT-7.5.
        - string:
            name: Compose_Version
            default: "1.0"
            description: Please set correct compose version here, set 1.1 if the compose is RHEL 7.5 RC 1.1.
        - string:
            name: Docker_image_id
            default:
            description: Set the docker image id, such as 8.0-608.
        - choice:
            name: Test_Type
            choices:
              - Beta
              - HTB_Beta
              - HTB_Snapshot
              - GA
            description: Choose correct test phase.
        - string:
            name: SAT6_Server_Hostname
            default: smqa-x3650-01-vm01.lab.eng.brq.redhat.com
            description: Fill in the hostname of Satellite 6 Server here.
        - string:
            name: SAT6_Server_IP
            default:
            description: Optional. Fill in the IP address of Satellite 6 Server here if the Satellite 6 server hostname is not registered in DNS server.
        - string:
            name: SAT6_Server_Username
            default: admin
            description: Fill in the username of Satellite 6 Server here.
        - string:
            name: SAT6_Server_Password
            default: changeme
            description: Fill in above username's password of Satellite 6 Server here.
        - string:
            name: SAT6_Server_OrgLabel
            default: Entitlements_QE
            description: Fill in the organization label of Satellite 6 Server here.
        - choice:
            name: CDN
            choices:
              - QA
              - Stage
              - Prod
            description:
        - choice:
            name: Candlepin
            choices:
              - Stage
              - Prod
            description:
        - extended-choice:
            name: Hosts
            description: Optional. Select Host machines to do testing.
            type: 'PT_CHECKBOX'
            value: RHEL7-x86_64,RHEL8-x86_64,RHEL7-ppc64le,RHEL-ALT-ppc64le,RHEL8-ppc64le,RHEL7-s390x,RHEL-ALT-s390x,RHEL8-s390x,RHEL8-aarch64,RHEL-ALT-aarch64
            visible-item-count: "10"
   scm:
        - git:
            url: 'http://git.app.eng.bos.redhat.com/git/entitlement-tests.git'
            branches:
                - origin/master
            basedir: entitlement-tests
            git-config-name: 'ftan'
            git-config-email: 'ftan@redhat.com'
   builders:
        - shell: |
            #!/bin/bash
            export Hosts=$Hosts

            cp $WORKSPACE/entitlement-tests/CI/jobs/Container/upstream_trigger_files/*.properties .
            python $WORKSPACE/entitlement-tests/analyze_testing.py container
            echo "The final properties files:"
            ls *.properties
   publishers:
      - archive:
          artifacts: '*.properties'
          allow-empty: 'true'
      - trigger-parameterized-builds:
          - project: 'Container-RHEL8-x86_64'
            current-parameters: true
            condition: 'SUCCESS'
            property-file: RHEL8-x86_64.properties
            fail-on-missing: true
          - project: 'Container-RHEL7-x86_64'
            current-parameters: true
            condition: 'SUCCESS'
            property-file: RHEL7-x86_64.properties
            fail-on-missing: true
          - project: 'Container-RHEL8-ppc64le'
            current-parameters: true
            condition: 'SUCCESS'
            property-file: RHEL8-ppc64le.properties
            fail-on-missing: true
          - project: 'Container-RHEL7-ppc64le'
            current-parameters: true
            condition: 'SUCCESS'
            property-file: RHEL7-ppc64le.properties
            fail-on-missing: true
          - project: 'Container-RHEL-ALT-ppc64le'
            current-parameters: true
            condition: 'SUCCESS'
            property-file: RHEL-ALT-ppc64le.properties
            fail-on-missing: true
          - project: 'Container-RHEL8-s390x'
            current-parameters: true
            condition: 'SUCCESS'
            property-file: RHEL8-s390x.properties
            fail-on-missing: true
          - project: 'Container-RHEL7-s390x'
            current-parameters: true
            condition: 'SUCCESS'
            property-file: RHEL7-s390x.properties
            fail-on-missing: true
          - project: 'Container-RHEL-ALT-s390x'
            current-parameters: true
            condition: 'SUCCESS'
            property-file: RHEL-ALT-s390x.properties
            fail-on-missing: true
          - project: 'Container-RHEL8-aarch64'
            current-parameters: true
            condition: 'SUCCESS'
            property-file: RHEL8-aarch64.properties
            fail-on-missing: true
          - project: 'Container-RHEL-ALT-aarch64'
            current-parameters: true
            condition: 'SUCCESS'
            property-file: RHEL-ALT-aarch64.properties
            fail-on-missing: true

- project:
   name: ContainerSAT6TestingTriggerJobs
   jobs:
    - ContainerSAT6TestingTrigger


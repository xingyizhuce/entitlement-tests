- job-template:
    name: 'Container_upload_xml_result_to_polarion'
    node: entitlement
    description: |
        Purpose: Merge and upload Container testing xml result to polarion.
    concurrent: true
    scm:
        - git:
            url: 'http://git.app.eng.bos.redhat.com/git/entitlement-tests.git'
            branches:
                - origin/master
            basedir: entitlement-tests
            git-config-name: 'ftan'
            git-config-email: 'ftan@redhat.com'
    parameters:
        - string:
            name: Test_Product
            default: RHEL80
            description: Optional. Fill in the test product like 'RHEL80','RHEL76' which will be put into the polarion test run id. If this filed is empty, it will just use the test run id of the first merged xml.
        - string:
            name: XML_URL_1
            default: 
            description:
        - string:
            name: XML_URL_2
            default:
            description:
        - string:
            name: XML_URL_3
            default:
            description:
        - string:
            name: XML_URL_4
            default:
            description:
        - string:
            name: XML_URL_5
            default:
            description:
        - string:
            name: XML_URL_6
            default:
            description:
        - string:
            name: XML_URL_7
            default:
            description:
        - string:
            name: XML_URL_8
            default:
            description:
        - string:
            name: XML_URL_9
            default:
            description:
        - string:
            name: XML_URL_10
            default:
            description:
        - string:
            name: XML_URL_11
            default:
            description:
        - string:
            name: XML_URL_12
            default:
            description:
        - string:
            name: XML_URL_13
            default:
            description:
        - string:
            name: XML_URL_14
            default:
            description:
        - string:
            name: XML_URL_15
            default:
            description:
        - string:
            name: XML_URL_16
            default:
            description:
        - string:
            name: XML_URL_17
            default:
            description:
        - string:
            name: XML_URL_18
            default:
            description:
    builders:
        - shell: |
            #!/bin/bash
            rm -rf xml
            mkdir xml
            pushd xml
            xml_url_list="$XML_URL_1 $XML_URL_2 $XML_URL_3 $XML_URL_4 $XML_URL_5 $XML_URL_6 $XML_URL_7 $XML_URL_8 $XML_URL_9 $XML_URL_10 $XML_URL_11 $XML_URL_12 $XML_URL_13 $XML_URL_14 $XML_URL_15 $XML_URL_16 $XML_URL_17 $XML_URL_18"
            for url in $xml_url_list; do
                wget --no-check-certificate $url
            done
            popd

            python entitlement-tests/CI/polarion/merge_polarion_xml_log.py xml/*
    publishers:
        - archive:
            artifacts: 'nosetests-final.xml'
            allow-empty: 'true'
        - ci-polarion-importer:
            files: 'nosetests-final.xml'
            wait: True
            mark-failed: True
            importer_url: 'https://polarion.engineering.redhat.com/polarion/import/xunit'
            user: 'platformqe_machine'
            password: 'polarion'
            provider-name: 'Red Hat UMB'
            override-topic: Consumer.rh-jenkins-ci-plugin.cb8a05ac-493c-42ee-9529-0aa113fc35ba.VirtualTopic.qe.ci.>
            timeout: '60'
    wrappers:
        - ansicolor
        - workspace-cleanup
        - timestamps

- project:
   name: Container_polarion_project
   jobs:
    - Container_upload_xml_result_to_polarion
